<!-- Content Security Policy optimized for Google AdSense -->
<meta http-equiv="Content-Security-Policy" content="
  default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob:;
  script-src 'self' 'unsafe-inline' 'unsafe-eval' 
    https://pagead2.googlesyndication.com 
    https://googleads.g.doubleclick.net 
    https://www.google.com 
    https://www.gstatic.com 
    https://securepubads.g.doubleclick.net 
    https://tpc.googlesyndication.com 
    https://www.googletagmanager.com 
    https://www.google-analytics.com 
    https://ssl.google-analytics.com
    https://fonts.googleapis.com
    https://cdnjs.cloudflare.com
    https://cdn.jsdelivr.net
    data: blob:;
  style-src 'self' 'unsafe-inline' 
    https://fonts.googleapis.com 
    https://fonts.gstatic.com
    https://cdnjs.cloudflare.com
    https://cdn.jsdelivr.net
    https://pagead2.googlesyndication.com
    https://googleads.g.doubleclick.net;
  img-src 'self' data: blob: 
    https://pagead2.googlesyndication.com 
    https://googleads.g.doubleclick.net 
    https://www.google.com 
    https://www.gstatic.com 
    https://securepubads.g.doubleclick.net 
    https://tpc.googlesyndication.com
    https://www.google-analytics.com
    https://ssl.google-analytics.com
    https://fonts.gstatic.com
    *;
  font-src 'self' 
    https://fonts.googleapis.com 
    https://fonts.gstatic.com
    https://cdnjs.cloudflare.com
    data:;
  connect-src 'self' 
    https://pagead2.googlesyndication.com 
    https://googleads.g.doubleclick.net 
    https://www.google.com 
    https://www.gstatic.com 
    https://securepubads.g.doubleclick.net 
    https://tpc.googlesyndication.com
    https://www.google-analytics.com
    https://ssl.google-analytics.com;
  frame-src 'self' 
    https://pagead2.googlesyndication.com 
    https://googleads.g.doubleclick.net 
    https://www.google.com 
    https://www.gstatic.com 
    https://securepubads.g.doubleclick.net 
    https://tpc.googlesyndication.com;
  object-src 'none';
  base-uri 'self';
  form-action 'self';
  upgrade-insecure-requests;
">

<!-- Alternative CSP for older browsers -->
<meta http-equiv="X-Content-Security-Policy" content="
  default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://pagead2.googlesyndication.com https://googleads.g.doubleclick.net https://www.google.com https://www.gstatic.com https://securepubads.g.doubleclick.net https://tpc.googlesyndication.com https://www.googletagmanager.com https://www.google-analytics.com https://ssl.google-analytics.com https://fonts.googleapis.com https://fonts.gstatic.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net *;
">

<!-- WebKit CSP -->
<meta http-equiv="X-WebKit-CSP" content="
  default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://pagead2.googlesyndication.com https://googleads.g.doubleclick.net https://www.google.com https://www.gstatic.com https://securepubads.g.doubleclick.net https://tpc.googlesyndication.com https://www.googletagmanager.com https://www.google-analytics.com https://ssl.google-analytics.com https://fonts.googleapis.com https://fonts.gstatic.com https://cdnjs.cloudflare.com https://cdn.jsdelivr.net *;
">

<!-- Permissions Policy for AdSense -->
<meta http-equiv="Permissions-Policy" content="
  accelerometer=(),
  autoplay=(),
  camera=(),
  cross-origin-isolated=(),
  display-capture=(),
  encrypted-media=(),
  fullscreen=(),
  geolocation=(),
  gyroscope=(),
  keyboard-map=(),
  magnetometer=(),
  microphone=(),
  midi=(),
  payment=(),
  picture-in-picture=(),
  publickey-credentials-get=(),
  screen-wake-lock=(),
  sync-xhr=(),
  usb=(),
  web-share=(),
  xr-spatial-tracking=()
">

<!-- Feature Policy (deprecated but still supported) -->
<meta http-equiv="Feature-Policy" content="
  accelerometer 'none';
  autoplay 'none';
  camera 'none';
  encrypted-media 'none';
  fullscreen 'self';
  geolocation 'none';
  gyroscope 'none';
  magnetometer 'none';
  microphone 'none';
  midi 'none';
  payment 'none';
  picture-in-picture 'none';
  speaker 'self';
  sync-xhr 'self';
  usb 'none';
  vr 'none'
">

<!-- Referrer Policy -->
<meta name="referrer" content="strict-origin-when-cross-origin">

<!-- Additional Security Headers -->
<meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta http-equiv="X-XSS-Protection" content="1; mode=block">

<!-- HSTS (HTTP Strict Transport Security) -->
<meta http-equiv="Strict-Transport-Security" content="max-age=31536000; includeSubDomains; preload">

<!-- DNS Prefetch for AdSense domains -->
<link rel="dns-prefetch" href="//pagead2.googlesyndication.com">
<link rel="dns-prefetch" href="//googleads.g.doubleclick.net">
<link rel="dns-prefetch" href="//www.google.com">
<link rel="dns-prefetch" href="//www.gstatic.com">
<link rel="dns-prefetch" href="//securepubads.g.doubleclick.net">
<link rel="dns-prefetch" href="//tpc.googlesyndication.com">
<link rel="dns-prefetch" href="//fonts.googleapis.com">
<link rel="dns-prefetch" href="//fonts.gstatic.com">

<!-- Preconnect for critical AdSense resources -->
<link rel="preconnect" href="https://pagead2.googlesyndication.com" crossorigin>
<link rel="preconnect" href="https://googleads.g.doubleclick.net" crossorigin>
<link rel="preconnect" href="https://www.google.com" crossorigin>
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

<!-- Script to handle CSP violations -->
<script>
document.addEventListener('securitypolicyviolation', function(e) {
  // Log CSP violations for debugging (remove in production)
  console.warn('CSP Violation:', {
    blockedURI: e.blockedURI,
    violatedDirective: e.violatedDirective,
    originalPolicy: e.originalPolicy,
    documentURI: e.documentURI,
    referrer: e.referrer,
    lineNumber: e.lineNumber,
    columnNumber: e.columnNumber,
    sourceFile: e.sourceFile
  });
  
  // Send violation report to server (optional)
  // fetch('/csp-violation-report', {
  //   method: 'POST',
  //   headers: { 'Content-Type': 'application/json' },
  //   body: JSON.stringify({
  //     blockedURI: e.blockedURI,
  //     violatedDirective: e.violatedDirective,
  //     documentURI: e.documentURI,
  //     timestamp: new Date().toISOString()
  //   })
  // });
});
</script>

